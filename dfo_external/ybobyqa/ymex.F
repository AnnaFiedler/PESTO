#include <fintrf.h>

	SUBROUTINE MEXFUNCTION(NLHS, PLHS, NRHS, PRHS)
	
C		input variables
		MWPOINTER PLHS(*), PRHS(*)
		
C		more variables
		INTEGER N,NPT
		REAL*8 X(2),LB(2),UB(2),W(500000)
		
C		mex stuff
		INTEGER MEXCALLMATLAB
		MWPOINTER MXCREATEDOUBLEMATRIX,MXGETPR	
		MWSIZE MXGETM,MXGETN,N
		
C       interpret input

C		pN = MXGETPR(PRHS(1))
C		pX = MXGETPR(PRHS(2))
C		pXL = MXGETPR(PRHS(3))
C		pXU = MXGETPR(PRHS(4))
		
		N = 2
		NPT = 3
		LB(1) = -2
		LB(2) = -2
		UB(1) = 2
		UB(2) = 2
		X(1) = -1
		X(2) = -1
		IPRINT = 0
		MAXFUN = 2500

		
C		def parameters
		RHOBEG=1.0D-1
		RHOEND=1.0D-6
		
		
C		CALL BOBYQA (N,NPT,X,XL,XU,RHOBEG,RHOEND,IPRINT,MAXFUN,W)
		
		PLHS(1) = MXCREATEDOUBLEMATRIX(1,2,0)
		pPLHS1 = MXGETPR(PLHS(1))
		CALL MXCOPYREAL8TOPTR(X,pPLHS1,2)
	
C		MWPOINTER PLHS1(*), PRHS1(*)
C		INTEGER NLHS1, NRHS1
		
C		NRHS1 = NRHS
C		PRHS1 = PRHS
		
C	MEXCALLMATLAB(NLHS1,PLHS1,NRHS1,PRHS1,'funHandleWrap')
		
C		NLHS = NLHS1
C		PLHS = PLHS1
		
	END
		
		
		
		